#!/bin/bash

# 1. æ£€æŸ¥æ˜¯å¦æœ‰æ–‡ä»¶å˜åŠ¨
if [ -z "$(git status --porcelain)" ]; then
    echo "âœ¨ æ²¡æœ‰å‘ç°ä»»ä½•æ”¹åŠ¨ï¼Œæ— éœ€åŒæ­¥ã€‚"
    exit 0
fi

# --- æ–°å¢ï¼šæ˜¾ç¤ºå˜åŠ¨çš„æ–‡ä»¶åˆ—è¡¨ ---
echo "------------------------------------------------"
echo "ğŸ“‚ æ£€æµ‹åˆ°ä»¥ä¸‹æ–‡ä»¶å‘ç”Ÿäº†å˜åŠ¨ï¼š"
# ä½¿ç”¨ git status -s æ˜¾ç¤ºç²¾ç®€çŠ¶æ€ï¼šM ä»£è¡¨ä¿®æ”¹ï¼ŒA ä»£è¡¨æ–°å¢ï¼ŒD ä»£è¡¨åˆ é™¤
git status -s
echo "------------------------------------------------"

# 2. æç¤ºè¾“å…¥æœ¬æ¬¡ä¿®æ”¹çš„å†…å®¹æè¿°
echo "ğŸš€ è¯·è¾“å…¥æœ¬æ¬¡æäº¤çš„æè¿° (Description):"
read desc

# å¦‚æœç”¨æˆ·ç›´æ¥å›è½¦ï¼Œç»™ä¸€ä¸ªé»˜è®¤æè¿°
if [ -z "$desc" ]; then
  # è·å–å˜åŠ¨æ–‡ä»¶çš„ç®€è¦ç»Ÿè®¡ä½œä¸ºé»˜è®¤æè¿°ï¼Œæ¯”å¦‚ "Changes in 3 files"
  file_count=$(git status --porcelain | wc -l)
  desc="Update $file_count files at $(date +'%Y-%m-%d %H:%M:%S')"
fi

# 3. æ‰§è¡Œ Git ä¸‰éƒ¨æ›²
echo "æ­£åœ¨æš‚å­˜æ–‡ä»¶..."
git add .

echo "æ­£åœ¨æäº¤: $desc"
git commit -m "$desc"

echo "æ­£åœ¨æ¨é€åˆ° GitHub..."
git push origin main

echo "âœ… åŒæ­¥å®Œæˆï¼"